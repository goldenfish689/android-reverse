2025-9-9æ—¥æ›´æ–°:
ï¼ˆä¸Šé¢è¿™ä¸ªå°å°çš„è„šæœ¬ï¼Œæœ¬äººç”¨å®ƒçªç ´äº†2ä¸ªvmp+ollvmé¡¹ç›®çš„é˜²æŠ¤ï¼Œå—ç›ŠåŒªæµ…ï¼ï¼ï¼ï¼‰


åŸºäºFrida Hookçš„VMP+OLLVMé€†å‘åˆ†ææ–¹æ¡ˆ
é¡¹ç›®ç®€ä»‹
æœ¬æ–‡åˆ†äº«ä¸€ç§ç®€åŒ–çš„VMP+OLLVMæ··æ·†è¿˜åŸæ–¹æ¡ˆï¼Œé€šè¿‡FridaåŠ¨æ€HookæŠ€æœ¯ç»•è¿‡å¤æ‚çš„é™æ€åˆ†æï¼Œå®ç°å…³é”®é€»è¾‘çš„å¿«é€Ÿè¿˜åŸã€‚
å¼€æºåœ°å€ï¼š https://github.com/goldenfish689/android-reverse/tree/main/hooksAndroid
èƒŒæ™¯ä¸æŒ‘æˆ˜
åœ¨Androidé€†å‘å·¥ç¨‹ä¸­ï¼ŒVMPï¼ˆVirtual Machine Protectï¼‰ä¸OLLVMï¼ˆObfuscator-LLVMï¼‰çš„ç»„åˆæ˜¯ç›®å‰æœ€å¸¸è§çš„ä»£ç æ··æ·†é˜²æŠ¤æ‰‹æ®µã€‚ä¼ ç»Ÿçš„åº”å¯¹æ–¹å¼é€šå¸¸åŒ…æ‹¬ï¼š

ç¬¦å·æ‰§è¡Œï¼šä½¿ç”¨å·¥å…·è¿›è¡ŒæŠ½è±¡æ‰§è¡Œåˆ†æ
æ¨¡æ‹Ÿæ‰§è¡Œï¼šå€ŸåŠ©Unicornã€Unidbgç­‰æ¡†æ¶
æ‰‹åŠ¨åˆ†æï¼šç»“åˆé™æ€åˆ†æå·¥å…·è¿›è¡Œäººå·¥é€†å‘

è¿™äº›æ–¹æ³•è™½ç„¶æœ‰æ•ˆï¼Œä½†å¾€å¾€éœ€è¦æŠ•å…¥å¤§é‡æ—¶é—´å’Œç²¾åŠ›ï¼Œä¸”å¯¹åˆ†æäººå‘˜çš„æŠ€æœ¯æ°´å¹³è¦æ±‚è¾ƒé«˜ã€‚
è§£å†³æ–¹æ¡ˆ
æ ¸å¿ƒæ€è·¯
æœ¬æ–¹æ¡ˆæå‡ºäº†ä¸€ç§å›å½’ç®€å•çš„åˆ†ææ–¹æ³•ï¼šå®Œå…¨ç»•è¿‡æŒ‡ä»¤çº§åˆ†æï¼Œé€šè¿‡Frida Hookæ—¥å¿—è¿˜åŸå…³é”®é€»è¾‘ã€‚
æ–¹æ³•ä¼˜åŠ¿

âœ… æ— éœ€å…³æ³¨æŒ‡ä»¤æ··æ·†ï¼šä¸ç”¨åˆ†æå¤æ‚çš„æ±‡ç¼–æŒ‡ä»¤
âœ… å¿½ç•¥å­—ç¬¦ä¸²æ··æ·†ï¼šç›´æ¥è§‚å¯Ÿè¿è¡Œæ—¶è¡Œä¸º
âœ… ç»•è¿‡æ§åˆ¶æµå˜åŒ–ï¼šä¸“æ³¨äºå‡½æ•°è°ƒç”¨å…³ç³»
âœ… é«˜æ•ˆå¿«é€Ÿï¼šå¤§å¹…å‡å°‘åˆ†ææ—¶é—´

å®ç°åŸç†
é€šè¿‡å…¨é¢Hookä»¥ä¸‹å…³é”®æ¥å£ï¼Œæ„å»ºå®Œæ•´çš„å‡½æ•°è°ƒç”¨é“¾ï¼š

libcåº“å‡½æ•°ï¼šç³»ç»Ÿåº•å±‚APIè°ƒç”¨
JNIå‡½æ•°ï¼šJavaä¸Nativeäº¤äº’æ¥å£
ä¸Šå±‚Javaå‡½æ•°ï¼šåº”ç”¨å±‚é€»è¾‘è°ƒç”¨

ç»“åˆå¯¹Android SDK/NDKæ¥å£çš„æ·±å…¥ç†è§£ï¼Œå¯ä»¥ä»Hookæ—¥å¿—ä¸­å¿«é€Ÿè¯†åˆ«å’Œè¿˜åŸå…³é”®ä¸šåŠ¡é€»è¾‘ã€‚
æŠ€æœ¯å®ç°
libcåº“å‡½æ•°Hook
å¯¹æ‰€æœ‰libcåº“å‡½æ•°è¿›è¡Œå…¨é‡Hookç›‘æ§ï¼Œæ•è·ï¼š

å‡½æ•°è°ƒç”¨æ—¶æœº
å‚æ•°ä¼ é€’å†…å®¹
è¿”å›å€¼ä¿¡æ¯
è°ƒç”¨å †æ ˆå…³ç³»

åˆ†ææµç¨‹

éƒ¨ç½²Hookè„šæœ¬ï¼šä½¿ç”¨æä¾›çš„Fridaè„šæœ¬
è¿è¡Œç›®æ ‡ç¨‹åºï¼šè§¦å‘å…³é”®é€»è¾‘æ‰§è¡Œ
æ”¶é›†æ—¥å¿—æ•°æ®ï¼šè·å–å®Œæ•´çš„å‡½æ•°è°ƒç”¨è®°å½•
é€»è¾‘è¿˜åŸï¼šåŸºäºè°ƒç”¨æ¨¡å¼åˆ†æä¸šåŠ¡é€»è¾‘
éªŒè¯ç»“æœï¼šç¡®è®¤è¿˜åŸé€»è¾‘çš„æ­£ç¡®æ€§

é€‚ç”¨åœºæ™¯
æ­¤æ–¹æ¡ˆç‰¹åˆ«é€‚ç”¨äºï¼š

éœ€è¦å¿«é€Ÿäº†è§£ç¨‹åºæ ¸å¿ƒé€»è¾‘çš„åœºæ™¯
ä¼ ç»Ÿé™æ€åˆ†æé‡åˆ°ç“¶é¢ˆçš„æƒ…å†µ
å¯¹æ··æ·†ç¨‹åº¦è¾ƒé«˜çš„soæ–‡ä»¶åˆ†æ
æ—¶é—´ç´§è¿«çš„é€†å‘åˆ†æä»»åŠ¡

é¡¹ç›®ç‰¹ç‚¹

ğŸ”§ å¼€ç®±å³ç”¨ï¼šæä¾›å®Œæ•´çš„Hookè„šæœ¬
ğŸ“š æ–‡æ¡£è¯¦ç»†ï¼šåŒ…å«ä½¿ç”¨è¯´æ˜å’Œæ¡ˆä¾‹
ğŸ¯ å®æˆ˜éªŒè¯ï¼šåœ¨å¤šä¸ªå®é™…é¡¹ç›®ä¸­éªŒè¯æœ‰æ•ˆ
ğŸš€ æŒç»­æ›´æ–°ï¼šæ ¹æ®æ–°çš„æ··æ·†æŠ€æœ¯ä¸æ–­ä¼˜åŒ–

æ€»ç»“
ç›¸æ¯”ä¼ ç»Ÿçš„ç¬¦å·æ‰§è¡Œå’Œæ¨¡æ‹Ÿæ‰§è¡Œæ–¹æ¡ˆï¼ŒåŸºäºFrida Hookçš„æ–¹æ³•æä¾›äº†ä¸€æ¡æ›´åŠ ç›´æ¥å’Œé«˜æ•ˆçš„é€†å‘åˆ†æè·¯å¾„ã€‚é€šè¿‡è§‚å¯Ÿç¨‹åºçš„åŠ¨æ€è¡Œä¸ºè€Œéé™æ€ç»“æ„ï¼Œå¯ä»¥åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å¿«é€Ÿçªç ´VMP+OLLVMçš„æ··æ·†é˜²æŠ¤ï¼Œè·å¾—ç¨‹åºçš„æ ¸å¿ƒé€»è¾‘ã€‚
æ¬¢è¿å¤§å®¶ä½¿ç”¨å¹¶æä¾›åé¦ˆï¼Œå…±åŒå®Œå–„è¿™ä¸€é€†å‘åˆ†ææ–¹æ¡ˆï¼



***hook_jni_and_libc.jsä½¿ç”¨æ–¹æ³•ï¼š***

1ï¼Œæ›¿æ¢è„šæœ¬ä¸­çš„OLLVMåŠ å›ºçš„soã€‚  

2ï¼Œé…ç½®å¥½Fridaï¼Œåè¿è¡Œï¼šfrida -U -f com.yourapp.name -l hook_jni_and_libc.js --no-pause

**è§‚å¯Ÿæ—¥å¿—ï¼š**


......

JNIHook]    jni function : [ReleaseStringUTFChars] called from:0x725d2b1e10

 [JNIHook]    jni function : [ReleaseStringUTFChars] called from:0x725d2b1e2c

 [JNIHook]    jni function : [ReleaseStringUTFChars] called from:0x725d2b1e48
 [LibcHook] strlen    called ,from: 0x725d2afd30
 strlen      called str:

 [JNIHook]    jni function : [FindClass] called from:0x725d2b1a14

 [JNIHook] FindClass:      Class Name: [android/os/Build]

 [JNIHook]    jni function : [GetStaticFieldID] called from:0x725d2b1ad4

 [JNIHook] GetStaticFieldID called
     Class: android.os.Build
     Field Name: MANUFACTURER
     Signature: Ljava/lang/String;

 [JNIHook]    jni function : [GetStaticFieldID] called from:0x725d2b1b40

 [JNIHook] GetStaticFieldID called
     Class: android.os.Build
     Field Name: BRAND
     Signature: Ljava/lang/String;

 [JNIHook]    jni function : [GetStaticFieldID] called from:0x725d2b1ba8

 [JNIHook] GetStaticFieldID called
     Class: android.os.Build
     Field Name: DISPLAY
     Signature: Ljava/lang/String;

 [JNIHook]    jni function : [GetStaticObjectField] called from:0x725d2b1bd8

 [JNIHook]    jni function : [GetStaticObjectField] called from:0x725d2b1bf8

 [JNIHook]    jni function : [GetStaticObjectField] called from:0x725d2b1c1c

 [JNIHook]    jni function : [GetStringUTFChars] called from:0x725d2b1c50

 [JNIHook]    jni function : [GetStringUTFChars] called from:0x725d2b1c84

 [JNIHook]    jni function : [GetStringUTFChars] called from:0x725d2b1cb8
 [LibcHook] strlen    called ,from: 0x725d2e000c
 strlen      called str: Xiaomi
 [LibcHook] strlen    called ,from: 0x725d2e000c
 strlen      called str: Xiaomi
 [LibcHook] strlen    called ,from: 0x725d2e000c
 strlen      called str: QKQ1.190828.002 test-keys
 [LibcHook] strstr    called ,from: 0x725d2b1d40
 strstr      called str1: xiaomi str2: other1
 [LibcHook] strstr    called ,from: 0x725d2b1d7c
 strstr      called str1: xiaomi str2: other1
 [LibcHook] strstr    called ,from: 0x725d2b1db8
 strstr      called str1: qkq1.190828.002 test-keys str2: other1

 [JNIHook]    jni function : [ReleaseStringUTFChars] called from:0x725d2b1e10

 [JNIHook]    jni function : [ReleaseStringUTFChars] called from:0x725d2b1e2c

 [JNIHook]    jni function : [ReleaseStringUTFChars] called from:0x725d2b1e48
 [LibcHook] strlen    called ,from: 0x725d2afd30
 strlen      called str: com.unity3d.player.UnityPlayerActivity

 [JNIHook]    jni function : [NewStringUTF] called from:0x725d2afd78

 [JNIHook]    jni function : [GetObjectClass] called from:0x725d2b3f38
 GetObjectClass called , class name:android.app.Application

 [JNIHook]    jni function : [GetMethodID] called from:0x725d2b3ff4

 [JNIHook] GetMethodID,         Method Name: [getPackageName]     Signature: ()Ljava/lang/String;     Class: [android.app.Application]

 [JNIHook]    jni function : [CallObjectMethodV] called from:0x725d3e5544
 Call XXX MethodV called - Class Name: android.app.Application, Method ID: 0x6fca3c38 (Method name not directly accessible)

......  


**é€æ¡åˆ†æJavaã€JNIã€Libcçš„è°ƒç”¨æ—¥å¿—ï¼Œè¿˜åŸé€»è¾‘ã€‚**
 
